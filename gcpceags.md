# Google Cloud Platform Compute Engine with AGS

![DNS Problem](https://raw.githubusercontent.com/shawnmflemingc/faq/92182c3c88daa7d0b0ebc75e2a1b75cd7344a64a/ShowingGCPProblem.PNG "Showing DNS problem")

The trailing . at the end of the Connection-specific DNS Suffix causes issues where the certificate won't be generated by ArcGIS Server on install. Navigating to `%Install%\ArcGIS\Server\framework\etc\certificates` you will find only a `keystorepass.dat` file in this condition and the ArcGIS Server Setup Wizard after install and licensing will fail to find a site at `https://localhost:6443/arcgis/manager`. 

Esri has this documented as `BUG-000162399 - Google Cloud Platform (GCP) include a trailing dot for the root domain in all provisioned machine`. This causes ArcGIS Server to fail for both new and existing deployments.

## Solution 1

Change the Windows HOSTS to have the FQDN resolve without the . at the end. 

## Solution 2

Create a hostname.properties file in `%Install%\ArcGIS\Server\framework\etc` and put a single line `hostname=interface.domain.com`
https://enterprise.arcgis.com/en/server/latest/deploy/windows/multiple-nic-cards-dns-entries.htm

Note this option does not require a fully qualified hostname and can just use the server name.

## Steps to have the certificates recreated

1. Stop ArcGIS Server service
2. Rename the folder `%Install%\ArcGIS\Server\framework\etc\certificates`
3. Start ArcGIS Server and the files will be generated.

To determine if the fix is working the certificates folder will contain files `arcgis.keystore`, `SelfSignedCertificate.cer` and the `keystorepass.dat` together. 
